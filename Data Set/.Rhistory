# You need to adjust the work environment to run this code
setwd("/Users/mingyang/Desktop/SMU/File Management & Database/7330-Term-Porject/Data Set")
library(tidyverse)
# text mining library
library(tidytext)
vis_dat(tweets)
#plotting and pipes
library(ggplot2)
#Look at data
library(visdat)
# Look at missing Data
library(naniar)
tweets = read_csv("fixed_location_tweets3.csv")
tweets = data.frame(tweets)
# Look at missing data
gg_miss_var(tweets)
# Look at TOP US STATES
tweets %>%
count(user_state,sort = TRUE) %>%
mutate(user_state = reorder(user_state, n)) %>%
na.omit()%>%
top_n(20)%>%
ggplot(aes(x=user_state,y=n))+
geom_col()+
coord_flip()+
labs(x = "Count",y="Location",title="Where Twitter users are from - unique State")
# Look at TOP WORLD CITIES
tweets %>%
count(user_city,sort = TRUE) %>%
mutate(user_city = reorder(user_city, n)) %>%
na.omit()%>%
top_n(20)%>%
ggplot(aes(x=user_city,y=n))+
geom_col()+
coord_flip()+
labs(x = "Count",y="Location",title="Where Twitter users are from - unique City")
# Look at TOP Countries
tweets %>%
count(user_country,sort = TRUE) %>%
mutate(user_country = reorder(user_country, n)) %>%
na.omit()%>%
top_n(20)%>%
ggplot(aes(x=user_country,y=n))+
geom_col()+
coord_flip()+
labs(x = "Count",y="Location",title="Where Twitter users are from - unique Country")
head(tweets$text)
########################################################################################
# Do some regex operation to get rid of urls and "\n" or "\r" new lines under text field
# Text processing - create function to remove url and new line in text
########################################################################################
clean_text = function(string){
#Remove URL
text = gsub("\\s?(f|ht)(tp)(s?)(://)([^\\.]*)[\\.|/](\\S*)","", text)
#Remove \r and \n
text = gsub("\r?\n|\r"," ",text)
return(text)
}
# Performance regex on tweets$text column
tweets$text = clean_text(tweets$text)
########################################################################################
# Do some regex operation to get rid of urls and "\n" or "\r" new lines under text field
# Text processing - create function to remove url and new line in text
########################################################################################
clean_text = function(string){
#Remove URL
string = gsub("\\s?(f|ht)(tp)(s?)(://)([^\\.]*)[\\.|/](\\S*)","", string)
#Remove \r and \n
string = gsub("\r?\n|\r"," ",string)
return(string)
}
# Performance regex on tweets$text column
tweets$text = clean_text(tweets$text)
head(tweets$text,20)
# Write just tweets comments column out to a csv
write.csv(tweets$text, "tweet_posts.csv", row.names=F)
dim(tweets)
tweet1 = read.csv("tweet_posts.csv",header = FALSE)
dim(tweet1)
tweet1 = read.csv("tweet_posts.csv",header = FALSE)
dim(tweet1)
